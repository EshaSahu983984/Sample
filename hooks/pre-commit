#!/bin/bash
# Branch naming enforcement

# Try to get branch name safely, even before first commit
branch_name=$(git symbolic-ref --short HEAD 2>/dev/null || echo "")

if [[ -z "$branch_name" ]]; then
  echo "⚠️  No branch found (first commit likely). Skipping branch name check."
  exit 0
fi

pattern="^(feature|bugfix|hotfix)\/[a-z0-9._-]+$"

if [[ ! $branch_name =~ $pattern ]]; then
  echo "❌ Invalid branch name: $branch_name"
  echo "Use: feature/<ticket>-short-desc or bugfix/<ticket>-desc"
  exit 1
fi

# Optionally run local linters (ruff/black) here
# ruff check .
# black --check .
exit 0
